import{minify as p}from"csso";import{minify as c}from"html-minifier-terser";import{cpus as m}from"os";import n from"sharp";import{optimize as h}from"svgo";import{minify as y}from"terser";import s from"./parse.js";import l from"./sharp-read.js";var O=async(i,e=2)=>{const f=new ImagePool(m().length);for(const r in i)if(Object.prototype.hasOwnProperty.call(i,r)){const o=i[r];if(!o)continue;switch(r){case"css":await s(`${i.path}**/*.css`,e,r,a=>p(a,o).css);break;case"html":await s(`${i.path}**/*.html`,e,r,async a=>await c(a,o));break;case"js":await s(`${i.path}**/*.{js,mjs,cjs}`,e,r,async a=>(await y(a,o)).code);break;case"sharp":await s(`${i.path}**/*.{avci,avcs,avif,avifs,gif,heic,heics,heif,heifs,jfif,jif,jpe,jpeg,jpg,png,raw,tiff,webp}`,e,r,async a=>await l(a,o),async a=>n(a));break;case"svg":await s(`${i.path}**/*.svg`,e,r,async a=>{const t=h(a,o);if(typeof t.error<"u"&&console.log(t.error),typeof t.data<"u")return t.data});break;default:break}}await f.close()};export{O as default};
