import u from"fast-glob";import o from"fs";import l from"./format-bytes.js";var d=async(n,f=2,c="",m=async s=>s,p=async s=>await o.promises.readFile(s,"utf-8"))=>{const s=await u(n),i={initial:0,files:0,total:0};for(const e of s)try{const t=(await o.promises.stat(e)).size;i.initial+=t;const a=await m(await p(e));if(!a)continue;if(t>Buffer.byteLength(a)){await o.promises.writeFile(e,a,"utf-8");const r=(await o.promises.stat(e)).size;i.files++,i.total+=t-r,f>1&&console.info("\x1B[32mCompressed "+e.replace(/^.*[\\\/]/,"")+" for "+await l(t-r)+" ("+((t-r)/t*100).toFixed(2)+"% reduction).\x1B[39m")}}catch{console.log("Error: Cannot compress file "+e+"!")}f>0&&i.files>0&&console.info("\x1B[32mSuccessfully compressed a total of "+i.files+" "+c.toUpperCase()+" "+(i.files===1?"file":"files")+" for "+await l(i.total)+".\x1B[39m")};export{d as default};
