import a from"fs";import l from"fast-glob";import*as u from"csso";import*as p from"html-minifier-terser";function c(n={}){var i;const t=Object.assign({path:"./dist/",css:{clone:!1,comments:!1,debug:!1,forceMediaMerge:!0,restructure:!0,sourceMap:!1},html:{caseSensitive:!0,collapseBooleanAttributes:!0,collapseInlineTagWhitespace:!1,collapseWhitespace:!0,conservativeCollapse:!1,continueOnParseError:!1,customAttrAssign:[],customAttrCollapse:"",customAttrSurround:[],customEventAttributes:[/^on[a-z]{3,}$/],decodeEntities:!1,html5:!0,ignoreCustomComments:[],ignoreCustomFragments:[],includeAutoGeneratedTags:!0,keepClosingSlash:!0,maxLineLength:null,minifyCSS:!0,minifyJS:!0,minifyURLs:!1,preserveLineBreaks:!1,preventAttributesEscaping:!1,processConditionalComments:!0,processScripts:["module"],quoteCharacter:"",removeAttributeQuotes:!0,removeComments:!0,removeEmptyAttributes:!0,removeEmptyElements:!1,removeOptionalTags:!1,removeRedundantAttributes:!0,removeScriptTypeAttributes:!0,removeStyleLinkTypeAttributes:!0,removeTagWhitespace:!0,sortAttributes:!0,sortClassName:!0,trimCustomFragments:!1,useShortDoctype:!0}},n);return t.path=(i=t.path)!=null&&i.endsWith("/")?t.path:`${t.path}/`,{name:"astro-critters",hooks:{"astro:build:done":async({pages:m})=>{const o={css:t.css?l.sync(`${t.path}**/*.css`):[],html:t.html?m.map(e=>{const s=e.pathname.endsWith("/")?e.pathname:`${e.pathname}/`,r=s==="404/"?"404.html":`${s}index.html`;return`${t.path}${r}`}):[]};for(const e in o)if(Object.prototype.hasOwnProperty.call(o,e))for(const s of o[e]){const r=await a.promises.readFile(s,"utf-8");switch(e){case"css":await a.promises.writeFile(s,u.minify(r,t.css).css,"utf-8");break;case"html":await a.promises.writeFile(s,await p.minify(r,t.html),"utf-8");break;default:break}}}}}}export{c as default};
