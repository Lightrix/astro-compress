import s from"fs";import m from"fast-glob";import*as l from"csso";import f from"html-minifier-terser";import{minify as u}from"terser";const n=async(a,r,e)=>{const i=await m(a);for(const t of i)switch(e){case"csso":await s.promises.readFile(t,"utf-8").then(async o=>{await s.promises.writeFile(t,l.minify(o,r).css,"utf-8")});break;case"html-minifier-terser":await s.promises.readFile(t,"utf-8").then(async o=>{await s.promises.writeFile(t,f.minify(o,r),"utf-8")});break;case"terser":await s.promises.writeFile(t,await u(t,r).code,"utf-8");break;default:break}};function c(a={}){var i;const e=Object.assign({path:"./dist/",css:{clone:!1,comments:!1,debug:!1,forceMediaMerge:!0,restructure:!0,sourceMap:!1},html:{caseSensitive:!0,collapseBooleanAttributes:!0,collapseInlineTagWhitespace:!1,collapseWhitespace:!0,conservativeCollapse:!1,continueOnParseError:!1,customAttrAssign:[],customAttrCollapse:"",customAttrSurround:[],customEventAttributes:[/^on[a-z]{3,}$/],decodeEntities:!1,html5:!0,ignoreCustomComments:[],ignoreCustomFragments:[],includeAutoGeneratedTags:!0,keepClosingSlash:!0,maxLineLength:null,minifyCSS:!0,minifyJS:!0,minifyURLs:!1,preserveLineBreaks:!1,preventAttributesEscaping:!1,processConditionalComments:!0,processScripts:["module"],quoteCharacter:"",removeAttributeQuotes:!0,removeComments:!0,removeEmptyAttributes:!0,removeEmptyElements:!1,removeOptionalTags:!1,removeRedundantAttributes:!0,removeScriptTypeAttributes:!0,removeStyleLinkTypeAttributes:!0,removeTagWhitespace:!0,sortAttributes:!0,sortClassName:!0,trimCustomFragments:!1,useShortDoctype:!0},js:{ecma:5,enclose:!1,keep_classnames:!1,keep_fnames:!1,ie8:!1,module:!1,safari10:!1,toplevel:!1}},a);return e.path=(i=e.path)!=null&&i.endsWith("/")?e.path:`${e.path}/`,{name:"astro-critters",hooks:{"astro:build:done":async()=>{e.css&&n(`${e.path}**/*.css`,e.css,"csso"),e.html&&n(`${e.path}**/*.html`,e.html,"html-minifier-terser"),e.js&&n(`${e.path}**/*.js`,e.js,"terser")}}}}export{c as default};
